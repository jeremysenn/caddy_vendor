.container
  %br
  %h3.text-xs-center= @customer.full_name

  %ul.nav.nav-tabs
    %li.nav-item
      %a.nav-link.active{:href => "#info", :data => {:toggle => "tab"}} 
        %i.fa.fa-vcard-o.fa-lg
        = "Info" unless browser.device.mobile?
    %li.nav-item
      %a.nav-link{:href => "#transfers", :data => {:toggle => "tab"}} 
        %i.fa.fa-dollar.fa-lg
        = "Transfers" unless browser.device.mobile?
    %li.nav-item
      %a.nav-link{:href => "#withdrawals", :data => {:toggle => "tab"}} 
        %i.fa.fa-bolt.fa-lg
        = "Withdrawals" unless browser.device.mobile?
  .tab-content
    .tab-pane.active{:id => "info"}
      %br
      .card
        .card-block
          %p.lead
            Cell phone:
            = @customer.PhoneMobile
          %p.lead
            Email:
            = @customer.Email
          %p.lead
            Courses:
            %br
            - @customer.caddies.where(ClubCompanyNbr: current_company.id).each do |caddy|
              = link_to caddy.course.name, caddy
              %br
          %p.lead
            Available Balance:
            = number_to_currency(@balance)
          %p.lead
            Minimum Balance:
            = number_to_currency(@minimum_balance)
          - if @balance > 1
            %p
              %a{href: '#', class: 'btn btn-success', "data-toggle" => "modal", "data-target" => "#sms_payment_qr_code"}
                %i.fa.fa-qrcode
                ATM Payment
              #sms_payment_qr_code.modal.fade{"aria-hidden" => "true", "aria-labelledby" => "exampleModalLabel", :role => "dialog", :tabindex => "-1"}
                .modal-dialog.modal-sm{:role => "document"}
                  .modal-content
                    .modal-header
                      %button.close{"aria-label" => "Close", "data-dismiss" => "modal", :type => "button"}
                        %span{"aria-hidden" => "true"} Ã—
                      .modal-title
                        .lead 
                          ATM Payment
                    .modal-body
                      %p.lead
                        Please enter your PIN:
                      = form_tag pin_verification_users_admin_path(current_user.id), id: 'send_caddy_sms_payment_verification_form', method: 'post' do |f|
                        =# hidden_field_tag :caddy_id, @caddy.id
                        .col-xs-9
                          = text_field_tag :pin, nil, placeholder: "Your PIN", class: "form-control input-lg", autofocus: true, required: true
                        .row
                          .col-xs-12
                            .pull-right
                              %br
                              %button.btn.btn-secondary{"data-dismiss" => "modal", :type => "button"} Cancel
                              %button.btn.btn-primary{id: 'send_sms_payment_qr_code_button', :type => "submit", data: {disable_with: "<i class='fa fa-spinner fa-spin'></i> Submit"}} 
                                Submit

    .tab-pane{:id => "transfers"}
      %br
      #caddy_transfers.collapse.show.in{"aria-expanded" => "true"}
        - unless @transfers.blank?
          .table-responsive
            %table.table.table-striped
              %thead
                %tr
                  %th Tran ID
                  %th Date/Time
                  %th From
                  %th Fee
                  %th Tip
                  %th Note
                  %th Total
                  %th
              %tbody
                - @transfers.each do |transfer|
                  %tr{class: "#{transfer.reversed? ? 'table-danger' : '' }"}
                    %td
                      - unless transfer.ez_cash_tran_id.blank?
                        = link_to transfer.ez_cash_tran_id, transaction_path(transfer.ez_cash_tran_id)
                      - else
                        None
                    %td= transfer.created_at.in_time_zone(transfer.course.time_zone).strftime("%-m/%-d/%y %l:%M %p")
                    %td= transfer.customer.full_name unless transfer.customer.blank?
                    %td= number_to_currency(transfer.caddy_fee)
                    %td= number_to_currency(transfer.caddy_tip)
                    %td= transfer.note
                    %td= number_to_currency(transfer.amount)
                    %td
                      - if transfer.reversed?
                        .text-danger Reversed
                      = link_to "Show", transfer, class: 'btn btn-secondary'
        - else
          %p.lead None

    .tab-pane{:id => "withdrawals"}
      %br
      #caddy_text_messages.collapse.show.in{"aria-expanded" => "true"}
        - unless @withdrawal_transactions.blank?
          .table-responsive
            %table.table.table-striped
              %thead
                %tr
                  %th ID
                  %th Date/Time
                  %th Code
                  %th Status
                  %th Requested
                  %th Authorized
                  %th Description
                  %th
              %tbody
                - @withdrawal_transactions.each do |withdrawal_transaction|
                  %tr
                    %td= withdrawal_transaction.id
                    %td= withdrawal_transaction.date_time.strftime("%-m/%-d/%y %l:%M %p")
                    %td= withdrawal_transaction.error_code_description
                    %td= withdrawal_transaction.status_description
                    %td= number_to_currency(withdrawal_transaction.amt_req)
                    %td= number_to_currency(withdrawal_transaction.amt_auth)
                    %td= withdrawal_transaction.Description
                    %td= link_to "Show", withdrawal_transaction, class: 'btn btn-secondary'
        - else
          %p.lead None