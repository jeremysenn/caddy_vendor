.container
  %br
  %p
    = form_tag caddies_path, id: 'caddies_form', method: 'get', class: 'form-inline' do |f|
      .input-group
        = search_field_tag :q, params[:q], :placeholder => "Search caddies", class: "form-control input-lg", autofocus: true
        %span.input-group-btn
          %button.btn.btn-secondary{id: 'caddy_search_button', :type => "submit", data: {disable_with: "<i class='fa fa-spinner fa-spin'></i>"}} 
            %i.fa.fa-search
      %small.text-muted Search by first name or last name

  .card.card-block
    %h4.card-title Caddies
    .table-responsive
      %table.table.table-striped
        %thead
          %tr
            %th Name
            %th Club
            %th Ranking
            %th Checked In
            %th
            %th
        %tbody
          - @caddies.each do |caddy|
            %tr
              %td= caddy.full_name
              %td= link_to caddy.club.name, caddy.club
              %td= link_to caddy.rank_description, caddy.caddy_rank_desc
              %td= caddy.CheckedIn.in_time_zone(current_user.time_zone).strftime("%l:%M %p") if caddy.checkin_today? 
              %td
                = link_to "Show", caddy, class: 'btn btn-secondary'
                = link_to 'Edit', edit_caddy_path(caddy), class: 'btn btn-primary'
              %td
                = simple_form_for(caddy) do |f|
                  - if caddy.checkin_today? 
                    = f.input_field :CheckedIn, as: :hidden, value: nil
                    = f.button :submit, "Check Out", class: 'btn btn-warning'
                  - else
                    = f.input_field :CheckedIn, as: :hidden, value: DateTime.now
                    = f.button :submit, "Check In", class: 'btn btn-success'
  = paginate @caddies