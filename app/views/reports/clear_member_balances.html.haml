.container-fluid
  %br
  %p.lead
    - unless params[:clearing_member_balances].present?
      .pull-right
        = form_tag reports_clear_member_balances_path, :method => 'get', :class => "form-inline" do
          = hidden_field_tag 'report[club_id]', @club.id
          = hidden_field_tag 'report[start_date]', @start_date
          = hidden_field_tag 'report[end_date]', @end_date
          = hidden_field_tag :clearing_member_balances, true
          =# button_tag(:type => 'submit', :class => "btn btn-danger #{(@transfers_total != @transactions_total or @transfers_total != @members_balance_total.abs) ? 'disabled' : ''} ", :data => { :confirm => 'Are you sure you want to clear these member balances? This action cannot be undone.' }) do
          - unless @transfers_total != @members_balance_total.abs
            = button_tag(:type => 'submit', :class => "btn btn-warning", :data => { :confirm => "Are you sure you want to clear these member balances? This action cannot be undone." }) do
              %i.fa.fa-refresh
              Clear Balances
          - else
            = button_tag(:type => 'submit', :class => "btn btn-danger", :data => { :confirm => "These totals don't match up. Are you sure you still want to clear these member balances? This action cannot be undone." }) do
              %i.fa.fa-exclamation-triangle
              Clear Balances
  %p.lead
    = @club.name
    = @start_date.to_datetime.strftime("%-m/%-d/%y %l:%M %p") unless @club.date_of_last_one_sided_credit_transaction.blank?
    = @start_date.to_datetime.strftime("%-m/%-d/%y %l:%M %p") if @club.date_of_last_one_sided_credit_transaction.blank?
    To
    = @end_date.to_datetime.strftime("%-m/%-d/%y %l:%M %p")

  .row
    .col-sm-6
      .card.card-block.card-outline-warning
        %h4.card-title.text-warning
          %i.fa.fa-user-circle-o
          = "Members (#{@members.count})"
          .pull-right
            = number_to_currency(@members_balance_total)
        - unless @members.blank?
          .table-responsive
            %table.table.table-striped
              %thead
                %tr
                  %th Member
                  %th Balance
                  %th
              %tbody
                - @members.each do |member|
                  - unless member.blank?
                    %tr
                      %td
                        = member.full_name
                        - unless member.parent_customer.blank?
                          %br
                          = link_to "(#{member.parent_customer.full_name})", member.parent_customer
                      %td
                        = number_to_currency(member.balance)
                      %td= link_to "Show", member, class: 'btn btn-secondary'
        - else
          %p.lead None
    .col-sm-6
      .card.card-block.card-outline-primary
        %h4.card-title.text-primary
          %i.fa.fa-dollar
          = "Round Transfers (#{@transfers.count})"
          .pull-right
            = number_to_currency(@transfers_total)
        - unless @transfers.blank?
          .table-responsive
            %table.table.table-striped
              %thead
                %tr
                  %th Date
                  %th Description
                  %th Note
                  %th Amount
                  %th
              %tbody
                - @transfers.each do |transfer|
                  %tr
                    %td= transfer.created_at.strftime("%-m/%-d/%y")
                    %td= transfer.description
                    %td= transfer.note
                    %td= number_to_currency(transfer.amount_paid_total)
                    %td= link_to "Show", transfer, class: 'btn btn-secondary'
        - else
          %p.lead None
    -#
      .col-sm-4
        .card.card-block.card-outline-success
          %h4.card-title.text-success
            %i.fa.fa-bolt
            = "EZcash (#{@transactions.count})"
            .pull-right
              = number_to_currency(@transactions_total)
          - unless @transactions.blank?
            .table-responsive
              %table.table.table-striped
                %thead
                  %tr
                    %th Date
                    %th Description
                    %th Amount
                    %th
                %tbody
                  - @transactions.each do |transaction|
                    %tr{class: "#{transaction.reversal? ? 'table-danger' : '' }"}
                      %td= transaction.date_time.in_time_zone(current_user.time_zone).strftime("%-m/%-d/%y")
                      %td= transaction.Description
                      %td= number_to_currency(transaction.total)
                      %td
                        = link_to "Show", transaction, class: 'btn btn-secondary'
          - else
            %p.lead None